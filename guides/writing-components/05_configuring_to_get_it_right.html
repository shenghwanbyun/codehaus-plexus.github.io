<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2015-09-13 
 | Rendered using Apache Maven Fluido Skin 1.4
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Rahul Thakur" />
    <meta name="Date-Revision-yyyymmdd" content="20150913" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Plexus &#x2013; Configuring Plexus Components</title>
    <link rel="stylesheet" href="../../css/apache-maven-fluido-1.4.min.css" />
    <link rel="stylesheet" href="../../css/site.css" />
    <link rel="stylesheet" href="../../css/print.css" media="print" />

      
    <script type="text/javascript" src="../../js/apache-maven-fluido-1.4.min.js"></script>

                          
        
<link rel="icon" type="image/x-icon" href="/favicon.ico"/>
                      
        
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"/>
          
                  </head>
        <body class="topBarDisabled">
          
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                                  <a href="../.././" id="bannerLeft">
                                                                                                <img src="../../images/plexus-logo-trans.png"  alt="Plexus"/>
                </a>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                              <li class="">
                    <a href="../../" title="Plexus">
        Plexus</a>
                    <span class="divider">/</span>
      </li>
        <li class="active ">Configuring Plexus Components</li>
        
                
                    
                  <li id="publishDate" class="pull-right"><span class="divider">|</span> Last Published: 2015-09-13</li>
            
                                    
    <li class="pull-right">
                      <a href="../.././" title="Plexus">
        Plexus</a>
      </li>

                    </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Parent Project</li>
                              
      <li>
  
                          <a href="../../dav:https:/dav.codehaus.org/plexus/index.html" title="Plexus">
          <span class="none"></span>
        Plexus</a>
            </li>
                                        <li class="nav-header">Plexus</li>
                              
      <li>
  
                          <a href="../../index.html" title="Overview">
          <span class="none"></span>
        Overview</a>
            </li>
                              <li class="nav-header">Plexus Projects</li>
                              
      <li>
  
                          <a href="../../modello/" title="Modello">
          <span class="none"></span>
        Modello</a>
            </li>
                
      <li>
  
                          <a href="../../plexus-classworlds/" title="Plexus Classworlds">
          <span class="none"></span>
        Plexus Classworlds</a>
            </li>
                
      <li>
  
                          <a href="../../plexus-containers/" title="Plexus Container">
          <span class="none"></span>
        Plexus Container</a>
            </li>
                
      <li>
  
                          <a href="../../plexus-components/" title="Plexus Components">
          <span class="none"></span>
        Plexus Components</a>
            </li>
                
      <li>
  
                          <a href="../../plexus-utils/" title="Plexus Utils">
          <span class="none"></span>
        Plexus Utils</a>
            </li>
                              <li class="nav-header">Downloads</li>
                              
      <li>
  
                          <a href="../../source-repository.html" title="Sources">
          <span class="none"></span>
        Sources</a>
            </li>
                
      <li>
  
                          <a href="../../download-binaries.html" title="Binaries">
          <span class="none"></span>
        Binaries</a>
            </li>
                              <li class="nav-header">Books</li>
                              
      <li>
  
                          <a href="../../writing-components-trail/index.html" title="Writing Components">
          <span class="none"></span>
        Writing Components</a>
            </li>
                              <li class="nav-header">Guides</li>
                              
      <li>
  
                          <a href="../../guides/quick-start/getting-started.html" title="Quick Start">
          <span class="none"></span>
        Quick Start</a>
            </li>
                
      <li>
  
                          <a href="../../guides/writing-components/00_index.html" title="Writing Plexus Components">
          <span class="none"></span>
        Writing Plexus Components</a>
            </li>
                
      <li>
  
                          <a href="../../guides/developer-guide/index.html" title="Developer Guide">
          <span class="none"></span>
        Developer Guide</a>
            </li>
                              <li class="nav-header">Reference</li>
                              
      <li>
  
                          <a href="../../ref/why-use-components.html" title="Why Use Components?">
          <span class="none"></span>
        Why Use Components?</a>
            </li>
                
      <li>
  
                          <a href="../../ref/plexus-descriptor.html" title="Plexus Descriptor">
          <span class="none"></span>
        Plexus Descriptor</a>
            </li>
                
      <li>
  
                          <a href="../../guides/developer-guide/configuration/component-descriptor.html" title="Component Descriptor">
          <span class="none"></span>
        Component Descriptor</a>
            </li>
                
      <li>
  
                          <a href="../../ref/component-configuration.html" title="Component Configuration">
          <span class="none"></span>
        Component Configuration</a>
            </li>
                
      <li>
  
                          <a href="../../ref/technical-articles.html" title="Technical Articles">
          <span class="none"></span>
        Technical Articles</a>
            </li>
                
      <li>
  
                          <a href="../../ref/available-components.html" title="Available Components">
          <span class="none"></span>
        Available Components</a>
            </li>
                
      <li>
  
                          <a href="../../faq.html" title="FAQs">
          <span class="none"></span>
        FAQs</a>
            </li>
                              <li class="nav-header">Community</li>
                              
      <li>
  
                          <a href="../../mail-lists.html" title="Mailing Lists">
          <span class="none"></span>
        Mailing Lists</a>
            </li>
                
      <li>
  
                          <a href="../../irc.html" title="IRC">
          <span class="none"></span>
        IRC</a>
            </li>
                
      <li>
  
                          <a href="../../get-involved.html" title="Get Involved">
          <span class="none"></span>
        Get Involved</a>
            </li>
                                        <li class="nav-header">Project Documentation</li>
                                                                                                                                      
      <li>
  
                          <a href="../../project-info.html" title="Project Information">
          <span class="icon-chevron-right"></span>
        Project Information</a>
                  </li>
                              <li class="nav-header">Plexus Projects</li>
                              
      <li>
  
                          <a href="../../dav:https:/dav.codehaus.org/plexus/plexus-classworlds/" title="Plexus Classworlds">
          <span class="none"></span>
        Plexus Classworlds</a>
            </li>
                
      <li>
  
                          <a href="../../dav:https:/dav.codehaus.org/plexus/plexus-containers/" title="Plexus Container">
          <span class="none"></span>
        Plexus Container</a>
            </li>
                
      <li>
  
                          <a href="../../dav:https:/dav.codehaus.org/plexus/plexus-components/" title="Plexus Components">
          <span class="none"></span>
        Plexus Components</a>
            </li>
                
      <li>
  
                          <a href="../../dav:https:/dav.codehaus.org/plexus/plexus-utils/" title="Plexus Utils">
          <span class="none"></span>
        Plexus Utils</a>
            </li>
            </ul>
                
                    
                            <form id="search-form" action="https://www.google.com/search" method="get" >
    
  <input value="http://codehaus-plexus.github.io/" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript" src="https://www.google.com/coop/cse/brand?form=search-form"></script>
          
          <hr />

           <div id="poweredBy">
                   
    <script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>

    
    <div class="g-plusone" data-href="http://codehaus-plexus.github.io/" data-size="tall" ></div>

                   <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <p><tt>The contents of this document are a work in progress</tt></p>
<div class="section">
<h2><a name="Configuring_a_Plexus_Component_via_descriptor"></a>Configuring a Plexus Component via descriptor</h2><!-- TODO: Start by changing the interface and factoring 'website' out and moving it to be a property in the component injectable by the Container based on configuration. -->
<p>We change the Component Role interface to look like this:</p>
<div class="source"><pre class="prettyprint linenums">public interface WebsiteMonitor
{

    /**
     * Role used to register component implementations with the container.
     */
    String ROLE = WebsiteMonitor.class.getName();

    /**
     * Monitor the specified website at the specified time intervals.
     * 
     * @throws Exception
     *             error encountered while performing the monitoring request.
     */
    public void monitor()
        throws Exception;

    /**
     * Specify a list of websites that can be monitored by this component.
     * 
     * @param websites List of websites
     */
    void addWebsites( List websites );

    /**
     * Determines if the website monitor component was properly initialized.
     *  
     * @return &lt;code&gt;true&lt;/code&gt; if initiailized, else &lt;code&gt;false&lt;/code&gt;.
     */
    boolean isInitialized();
}</pre></div>
<p>and, factor our component provider implementation to look like this:</p>
<div class="source"><pre class="prettyprint linenums">public class DefaultWebsiteMonitor
    extends AbstractLogEnabled
    implements WebsiteMonitor
{

    /**
     * Websites to monitor.
     * 
     * @plexus.configuration
     */
    private List websites;

    /**
     * @see org.codehaus.plexus.tutorial.WebsiteMonitor#monitor(java.lang.String)
     */
    public void monitor()
        throws Exception
    {
        HttpClient client = new HttpClient();

        for ( Iterator it = websites.iterator(); it.hasNext(); )
        {
            String website = (String) it.next();
            HttpMethod getMethod = new GetMethod( website );
            getMethod.setFollowRedirects( false );

            try
            {
                int statusCode = client.executeMethod( getMethod );

                if ( statusCode &lt; HttpStatus.SC_OK || statusCode &gt;= HttpStatus.SC_MULTIPLE_CHOICES )
                {
                    if ( getLogger().isErrorEnabled() )
                        getLogger().error(
                                           &quot;HTTP request returned HTTP status code: &quot; + statusCode + &quot; for website: &quot;
                                               + website );
                    throw new Exception( &quot;HTTP request returned HTTP status code: &quot; + statusCode + &quot; for website: &quot;
                        + website );
                }
                if ( getLogger().isInfoEnabled() )
                    getLogger().info(
                                      &quot;HTTP request returned HTTP status code: &quot; + statusCode + &quot; for website: &quot;
                                          + website );
            }
            catch ( UnknownHostException e )
            {
                if ( getLogger().isErrorEnabled() )
                    getLogger().error( &quot;Specified host '&quot; + website + &quot;' could not be resolved.&quot; );
                throw e;
            }
            finally
            {
                if ( null != getMethod )
                    getMethod.releaseConnection();
            }
        }
    }

    public void addWebsites( List websites )
    {
        this.websites = websites;
    }

    public boolean isInitialized()
    {
        return ( null != websites &amp;&amp; this.websites.size() &gt; 0 );
    }

}</pre></div>
<p>Note how <tt>'websites'</tt> is now a java.util.List property rather than a argument to the method. Also notice the annotation @plexus.configuration that indicates that this property is a plexus configuration element. This annotation is processed by Plexus' Component Descriptor Creator (or CDC). The CDC can parse and generate a components.xml from Java sources.</p>
<p>Now that we made <tt>'websites'</tt> to be a configuration property, we need to update the component's descriptor and specify values for websites. We add a list of websites as shown the the snippet below. Plexus container ensures that a component's fields are mapped and initialized and mapped from a component's configuration file. It can intelligently discover and map configuration items of different types like String, Lists (in this case). You can also specify you own configuration implementation class by specifying an <tt>'implementation'</tt> attribute on <tt>&lt;configuration</tt>&gt; element. Plexus will then attempt to inject the values from the XML configuration into the Configuration implementation's properties. Each of the nested element maps to a configuration property in the implementation class.</p><!-- TODO: Provide a link to page that discusses configuration mapping. -->
<p>This mandates a change in the descriptor, which now looks something like this:</p>
<div class="source"><pre class="prettyprint linenums">&lt;component-set&gt;
  &lt;components&gt;
    &lt;component&gt;
      &lt;role&gt;org.codehaus.plexus.tutorial.WebsiteMonitor&lt;/role&gt;
      &lt;implementation&gt;
        org.codehaus.plexus.tutorial.DefaultWebsiteMonitor
      &lt;/implementation&gt;
      &lt;configuration&gt;
        &lt;websites&gt;
          &lt;website&gt;http://www.google.co.nz/&lt;/website&gt;
          &lt;website&gt;http://www.nonexistent.yadayada3249834739547.org/&lt;/website&gt;
          &lt;website&gt;http://maven.apache.org/&lt;/website&gt;
        &lt;/websites&gt;
      &lt;/configuration&gt;
    &lt;/component&gt;
  &lt;/components&gt;
&lt;/component-set&gt;</pre></div><!-- TODO: May be add a time-interval configuration property such that the monitor can ping the specified site at regular intervals --><!-- TODO: add a MonitorResult to communicate the results of a Monitoring run back to the client. --></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                      <p >Copyright &copy;                    2001&#x2013;2015
                        <a href="http://codehaus-plexus.github.io/">Codehaus Plexus</a>.
            All rights reserved.      
                    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>